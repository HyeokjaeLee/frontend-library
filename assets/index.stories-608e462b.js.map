{"version":3,"file":"index.stories-608e462b.js","sources":["../../../src/hooks/private/useClosableOnClickOpeningState.tsx","../../../src/components/molecules/Selectbox/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nexport const useClosableOnClickOpeningState = () => {\n  const openingState = useState(false);\n  const [opened, setOpened] = openingState;\n\n  let closable = false;\n\n  useEffect(() => {\n    if (opened) {\n      const handleClickedOutside = () => {\n        if (closable) setOpened(false);\n      };\n\n      window.addEventListener('click', handleClickedOutside);\n      return () => window.removeEventListener('click', handleClickedOutside);\n    }\n  }, [closable, opened, setOpened]);\n\n  return {\n    openingState,\n    setClosableOnClick: (value: boolean) => {\n      closable = value;\n    },\n  };\n};\n","import { ChevronDown } from 'react-feather';\n\nimport type {\n  InputProps,\n  SelectProps,\n  InputWrapProps,\n} from '@components/atoms';\nimport { Select, Input } from '@components/atoms';\nimport type { ValidOptionValue, ValidateHandler } from '@hooks';\nimport {\n  useSubscribedState,\n  useValidationMessage,\n  useClosableOnClickOpeningState,\n} from '@hooks';\nimport { InputDisabled, Size } from '@types';\nimport { cleanClassName } from '@utils';\n\nimport styles from './index.module.scss';\n\nexport interface SelectboxProps<\n  TValidOptionValue extends ValidOptionValue = ValidOptionValue,\n  TMultiple extends boolean = false,\n> extends Omit<\n      InputProps,\n      | 'style'\n      | 'className'\n      | 'onChange'\n      | 'value'\n      | 'multiple'\n      | 'type'\n      | 'disabled'\n    >,\n    Pick<InputWrapProps, 'reversed' | 'className' | 'style'>,\n    Pick<\n      SelectProps<TValidOptionValue, TMultiple>,\n      'options' | 'float' | 'onChange' | 'value' | 'multiple' | 'cancelable'\n    > {\n  disabled?: InputDisabled;\n  size?: Size;\n  validation?: ValidateHandler<\n    SelectboxProps<TValidOptionValue, TMultiple>['value']\n  >;\n  children?: React.ReactNode;\n}\n\nexport const Selectbox = <\n  TValidOptionValue extends ValidOptionValue = ValidOptionValue,\n  TMultiple extends boolean = false,\n>({\n  //* Selectbox props\n  disabled,\n  size,\n  validation,\n  children,\n\n  //* Input.Wrap props\n  reversed,\n  className,\n  style,\n\n  //* Select props\n  options,\n  float,\n  onChange,\n  value,\n  multiple,\n\n  //* Input props\n  onClick,\n  placeholder,\n  id,\n  ...restInputProps\n}: SelectboxProps<TValidOptionValue, TMultiple>) => {\n  const [selectedValue, setSelectedValue] = useSubscribedState(value);\n\n  const selectedOption = multiple\n    ? options?.filter(({ value }) =>\n        (selectedValue as TValidOptionValue[])?.includes(value),\n      )\n    : options?.find(({ value }) => value === selectedValue);\n\n  const displayedValue = Array.isArray(selectedOption)\n    ? selectedOption.map(({ label }) => label).join(', ')\n    : selectedOption?.label;\n\n  const { validationMessage, validateValue } = useValidationMessage({\n    validateHandler: validation,\n    value: selectedValue,\n    id,\n  });\n\n  const {\n    openingState: [opened, setOpened],\n    setClosableOnClick,\n  } = useClosableOnClickOpeningState();\n\n  const changeOpened = () => setOpened((prev) => !prev);\n\n  const decoration = children ?? (\n    <ChevronDown\n      onClick={disabled ? undefined : () => changeOpened()}\n      className={cleanClassName(\n        `${styles['selectbox-icon']} ${\n          (float === 'top' ? !opened : opened) && styles.reversed\n        } ${disabled && styles.disabled}`,\n      )}\n    />\n  );\n\n  return (\n    <Input.Wrap\n      validationMessage={validationMessage}\n      size={size}\n      style={style}\n      className={className}\n      reversed={reversed}\n      readonly={disabled === 'readonly'}\n      onMouseEnter={() => setClosableOnClick(false)}\n      onMouseLeave={() => setClosableOnClick(true)}\n    >\n      <Input\n        {...restInputProps}\n        id={id}\n        type=\"button\"\n        onClick={(e) => {\n          onClick?.(e);\n          changeOpened();\n        }}\n        value={displayedValue}\n        disabled={!!disabled}\n        placeholder={placeholder}\n      />\n      {decoration ? (\n        <div className={styles.decoration}>{decoration}</div>\n      ) : null}\n      <Select\n        opened={opened}\n        options={options}\n        multiple={multiple}\n        value={selectedValue}\n        float={float}\n        onChange={(value) => {\n          setSelectedValue(value);\n          validateValue(value);\n          onChange?.(value);\n          setOpened(false);\n        }}\n      />\n    </Input.Wrap>\n  );\n};\n"],"names":["useClosableOnClickOpeningState","openingState","useState","opened","setOpened","closable","useEffect","handleClickedOutside","value","Selectbox","disabled","size","validation","children","reversed","className","style","options","float","onChange","multiple","onClick","placeholder","id","restInputProps","selectedValue","setSelectedValue","useSubscribedState","selectedOption","value2","displayedValue","label","validationMessage","validateValue","useValidationMessage","setClosableOnClick","changeOpened","prev","decoration","jsx","ChevronDown","cleanClassName","styles","jsxs","Input","Select"],"mappings":"orBAEO,MAAMA,GAAiC,IAAM,CAC5C,MAAAC,EAAeC,WAAS,EAAK,EAC7B,CAACC,EAAQC,CAAS,EAAIH,EAE5B,IAAII,EAAW,GAEfC,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAIH,EAAQ,CACV,MAAMI,EAAuB,IAAM,CAC7BF,GAAUD,EAAU,EAAK,CAAA,EAGxB,cAAA,iBAAiB,QAASG,CAAoB,EAC9C,IAAM,OAAO,oBAAoB,QAASA,CAAoB,EAEtE,EAAA,CAACF,EAAUF,EAAQC,CAAS,CAAC,EAEzB,CACL,aAAAH,EACA,mBAAqBO,GAAmB,CAC3BH,EAAAG,CACb,CAAA,CAEJ,yxBCoBOC,EAAA,CAAA,CAGL,SAAAC,EAEA,KAAAC,EACA,WAAAC,EACA,SAAAC,EACA,SAAAC,EAGA,UAAAC,EACA,MAAAC,EACA,QAAAC,EAGA,MAAAC,EACA,SAAAC,EACA,MAAAX,EACA,SAAAY,EACA,QAAAC,EAGA,YAAAC,EACA,GAAAC,EACA,GAAAC,CAEF,IAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAC,EAAAnB,CAAA,EAEAoB,EAAAR,EAAAH,GAAA,YAAAA,EAAA,OACa,CAAA,CAAA,MAAAY,CAAA,IAAAJ,GAAA,YAAAA,EAAA,SAAAI,IAC+CZ,GAAA,YAAAA,EAAA,KAAA,CAAA,CAAA,MAAAY,KAAAA,IAAAJ,GAI5DK,EAAA,MAAA,QAAAF,CAAA,EAAAA,EAAA,IAAA,CAAA,CAAA,MAAAG,CAAA,IAAAA,CAAA,EAAA,KAAA,IAAA,EAAAH,GAAA,YAAAA,EAAA,MAIA,CAAA,kBAAAI,EAAA,cAAAC,CAAA,EAAAC,EAAA,CAAkE,gBAAAtB,EAC/C,MAAAa,EACV,GAAAF,CACP,CAAA,EAGF,CAAM,aAAA,CAAApB,EAAAC,CAAA,EAC4B,mBAAA+B,CAChC,EAAAnC,GAAA,EAGFoC,EAAA,IAAAhC,EAAAiC,GAAA,CAAAA,CAAA,EAEAC,EAAAzB,GAAA0B,EAAA,IACEC,EAAC,CAAA,QAAA9B,EAAA,OAAA,IAAA0B,EAAA,EACoD,UAAAK,EACxC,GAAAC,EAAA,gBAAA,MAAAxB,IAAA,MAAA,CAAAf,EAAAA,IAAAuC,EAAA,YAAAhC,GAAAgC,EAAA,UAGc,CACzB,CAAA,EAIJ,OAAAC,EAAA,KACEC,EAAA,KAAO,CAAN,kBAAAZ,EACC,KAAArB,EACA,MAAAK,EACA,UAAAD,EACA,SAAAD,EACA,SAAAJ,IAAA,WACuB,aAAA,IAAAyB,EAAA,EAAA,EACqB,aAAA,IAAAA,EAAA,EAAA,EACD,SAAA,CAE3CI,EAAA,IAAAK,EAAC,CAAA,GAAApB,EACK,GAAAD,EACJ,KAAA,SACK,QAAA,GAAA,CAEHF,GAAA,MAAAA,EAAA,GACAe,GAAa,EACf,MAAAN,EACO,SAAA,CAAA,CAAApB,EACK,YAAAY,CACZ,CAAA,EACFgB,EAAAC,EAAAA,IAAA,MAAA,CAAA,UAAAG,EAAA,WAAA,SAAAJ,CAAA,CAAA,EAAA,KAGIC,EAAA,IACJM,GAAC,CAAA,OAAA1C,EACC,QAAAc,EACA,SAAAG,EACA,MAAAK,EACO,MAAAP,EACP,SAAAW,GAAA,CAEEH,EAAAG,CAAA,EACAI,EAAAJ,CAAA,EACAV,GAAA,MAAAA,EAAAU,GACAzB,EAAA,EAAA,CAAe,CACjB,CAAA,CACF,CAAA,CAAA,CAGN"}